@testable import EmfSpoolReader
import DataStream
import XCTest

final class HeaderTests: XCTestCase {
    func testExample() throws {
        do {
            /// [MS-EMFSPOOL] 3.2.1 EMFSPOOL Header Example
            /// This section provides an example of a Header record, as specified in section 2.2.2.
            let data: [UInt8] = [
                0x00, 0x00, 0x01, 0x00, 0x54, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00,
                0x4d, 0x00, 0x69, 0x00, 0x63, 0x00, 0x72, 0x00, 0x6F, 0x00, 0x73, 0x00, 0x6f, 0x00, 0x66, 0x00,
                0x74, 0x00, 0x20, 0x00, 0x57, 0x00, 0x6F, 0x00, 0x72, 0x00, 0x64, 0x00, 0x20, 0x00, 0x2D, 0x00,
                0x20, 0x00, 0x44, 0x00, 0x6f, 0x00, 0x63, 0x00, 0x75, 0x00, 0x6d, 0x00, 0x65, 0x00, 0x6E, 0x00,
                0x74, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4E, 0x00, 0x65, 0x00, 0x30, 0x00, 0x32, 0x00, 0x3A, 0x00,
                0x00, 0x00, 0x00, 0x00
            ]
            var dataStream = DataStream(data)
            let header = try EmfSpoolHeader(dataStream: &dataStream)
            XCTAssertEqual(0x00010000, header.dwVersion)
            XCTAssertEqual(0x00000054, header.cjSize)
            XCTAssertEqual(0x00000010, header.dpszDocName)
            XCTAssertEqual(0x00000046, header.dpszOutput)
        }
    }

    static var allTests = [
        ("testExample", testExample),
    ]
}
